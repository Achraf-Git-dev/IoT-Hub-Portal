@page "/gateways/logs"
@using AzureIoTHub.Portal.Shared.Models
@using Newtonsoft.Json;


<MudDialog>
    <DialogContent>
        <MudCard Outlined="true" Style="width:700px">
            <MudCardContent>
                <MudText>Status : @info.Status</MudText>
                <MudItem xs="12" sm="12" md="20">
                    <MudTextField Disabled="true" Value="@Indent(info.Payload)" Variant="Variant.Text" Lines="25"></MudTextField>
                </MudItem>
            </MudCardContent>
        </MudCard>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; }
    [Parameter] public C2Dresult info { get; set; }

    void Cancel() => MudDialog.Cancel();

    private dynamic Indent(string payload)
    {
        dynamic payloadGlo = JsonConvert.DeserializeObject(payload);
        string payloadModule = payloadGlo[0].payload;
        dynamic payloadFinal = JsonConvert.DeserializeObject(payloadModule);
        return payloadFinal;
    }
}
